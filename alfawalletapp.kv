#:kivy 2.0.0
# Критически важно, чтобы название kv файла не совпадало с walletapp
ScreenManagement:

    LoginPage:
        id: login_page
    UserPage:
        id: user_page
    RegistrationPage:
        id: registration_page
    AuthorizationPage:
        id: authorization_page

<LoginPage>:
    name: "login_page"
    canvas.before:
        Rectangle:
            pos: self.pos
            size: self.size
            source: "images/back.jpg"

    MDFloatLayout:
        size_hint: (0.6, 0.7)
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        size: self.parent.size
        padding_left: self.width * 0.07
        padding_right: self.width * 0.07
        padding_top: self.height * 0.03
        padding_bottom: self.height * 0.03
        Image:
            radius: 24
            box_color: 1, 1, 1, .2
            source: "images/login_page_image.jpg"
            pos_hint: {"center_x": 0.5, "top":1}
            width: root.width * 0.7
            height: self.parent.height * 0.30
            size_hint: (0.842, None)
        MDBoxLayout:
            size: self.parent.parent.size
            orientation: 'vertical'
            pos_hint: {"center_x": 0.5, "center_y": 0.75}
            padding_left: self.width * 0.07
            padding_right: self.width * 0.07
            padding_top: self.height * 0.03
            padding_bottom: self.height * 0.03
            spacing: self.height * 0.03

            MDRoundFlatButton:
                text: "Войти"
                font_size: 18
                # width: self.width * 0.4
                pos_hint: {"center_x": 0.5}
                text_color: "white"
                md_bg_color: (239/256, 49/256, 36/256, 1.0)
                on_press: app.root.current = "authorization_page"

            MDRoundFlatButton:
                text: "Зарегистрироваться"
                font_size: 18
                # width: self.width * 0.4
                pos_hint: {"center_x": 0.5}
                text_color: "white"
                md_bg_color: (239/256, 49/256, 36/256, 1.0)
                on_press: app.root.current = "registration_page"

<AuthorizationPage>:
    name: "authorization_page"
    canvas.before:
        Rectangle:
            pos: self.pos
            size: self.size
            source: "images/back.jpg"

    MDFloatLayout:
        size_hint: (0.6, 0.7)
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        size: self.parent.size
        padding_left: self.width * 0.07
        padding_right: self.width * 0.07
        padding_top: self.height * 0.03
        padding_bottom: self.height * 0.03
        Image:
            radius: 24
            box_color: 1, 1, 1, .2
            source: "images/login_page_image.jpg"
            pos_hint: {"center_x": 0.5, "top":1}
            width: root.width * 0.7
            height: self.parent.height * 0.30
            size_hint: (0.842, None)
        MDBoxLayout:
            size: self.parent.parent.size
            orientation: 'vertical'
            pos_hint: {"center_x": 0.5, "center_y": 0.75}
            padding_left: self.width * 0.07
            padding_right: self.width * 0.07
            padding_top: self.height * 0.03
            padding_bottom: self.height * 0.03
            spacing: self.height * 0.03

            MDTextField:
                mode: "round"
                md_bg_color: "white"
                hint_text: "Логин"
                icon_right: "eye-off"
                width: self.parent.width * 0.85
                size_hint_x: None
                font_size: 18
                pos_hint: {"center_x": 0.5}

            MDTextField:
                mode: "round"
                md_bg_color: "white"
                hint_text: "Пароль"
                icon_right: "eye-off"
                width: self.parent.width * 0.85
                size_hint_x: None
                font_size: 18
                pos_hint: {"center_x": 0.5}
                password: True

            MDRoundFlatButton:
                text: "Вход"
                font_size: 18
                # width: self.width * 0.4
                pos_hint: {"center_x": 0.5}
                text_color: "white"
                md_bg_color: (239/256, 49/256, 36/256, 1.0)
                on_press: app.root.current = "user_page"

<RegistrationPage>:
    name: "registration_page"
    canvas.before:
        Rectangle:
            pos: self.pos
            size: self.size
            source: "images/back.jpg"

    MDFloatLayout:
        size_hint: (0.6, 0.7)
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        size: self.parent.size
        padding_left: self.width * 0.07
        padding_right: self.width * 0.07
        padding_top: self.height * 0.03
        padding_bottom: self.height * 0.03
        Image:
            radius: 24
            box_color: 1, 1, 1, .2
            source: "images/login_page_image.jpg"
            pos_hint: {"center_x": 0.5, "top":1}
            width: root.width * 0.7
            height: self.parent.height * 0.30
            size_hint: (0.842, None)
        MDBoxLayout:
            size: self.parent.parent.size
            orientation: 'vertical'
            pos_hint: {"center_x": 0.5, "center_y": 0.75}
            padding_left: self.width * 0.07
            padding_right: self.width * 0.07
            padding_top: self.height * 0.03
            padding_bottom: self.height * 0.03
            spacing: self.height * 0.03

            MDTextField:
                mode: "round"
                md_bg_color: "white"
                hint_text: "Введите почту"
                icon_right: "eye-off"
                width: self.parent.width * 0.85
                size_hint_x: None
                font_size: 18
                pos_hint: {"center_x": 0.5}

            MDTextField:
                mode: "round"
                md_bg_color: "white"
                hint_text: "Введите пароль"
                icon_right: "eye-off"
                width: self.parent.width * 0.85
                size_hint_x: None
                font_size: 18
                pos_hint: {"center_x": 0.5}
                password: True
            MDTextField:
                mode: "round"
                md_bg_color: "white"
                hint_text: "Повторите пароль"
                icon_right: "eye-off"
                width: self.parent.width * 0.85
                size_hint_x: None
                font_size: 18
                pos_hint: {"center_x": 0.5}
                password: True

            MDRoundFlatButton:
                text: "Зарегистрироваться"
                font_size: 18
                # width: self.width * 0.4
                pos_hint: {"center_x": 0.5}
                text_color: "white"
                md_bg_color: (239/256, 49/256, 36/256, 1.0)
                on_press: app.root.current = "user_page"
<UserPage>:
    name: "user_page"
    opacity: 1
    MDBottomNavigation:
        radius: [17, 17, 0, 0]
        MDBottomNavigationItem:
            id: navigation_bottom_1
            name: "screen 1"
            text:
            icon: 'card-multiple-outline'
            disabled: False

            FloatLayout:
                id: screen_1
                MDBoxLayout:
                    orientation: 'vertical'
                    padding: [0, 15]
                    spacing: 20
                    disabled: False
                    MDTextField:
                        id: search
                        mode: "round"
                        hint_text: "поиск..."
                        icon_right: "magnify"
                        size_hint_x: 0.7
                        width: root.width
                        font_size: 18
                        pos_hint: {"center_x": 0.5}
                    ScrollView:
                        do_scroll_x: False
                        do_scroll_y: True
                        MDBoxLayout:
                            id: card_list
                            adaptive_height: True
                            orientation: 'vertical'
                            padding: [0, 15]
                            spacing: 20
                            
                            ElementCard:
                            ElementCard:
                            ElementCard:


        MDBottomNavigationItem:
            id: navigation_bottom_2
            name: "screen 2"
            text:
            icon: 'plus-circle-outline'
            disabled: False
            MDFloatLayout:
                id: screen_2
                opacity: 1
                MDBoxLayout:
                    id: shop_screen
                    orientation: 'vertical'
                    spacing: 15
                    padding: [15, 15, 15, 0]
                    MDTextField:
                        id: search
                        mode: "round"
                        hint_text: "поиск..."
                        icon_right: "magnify"
                        size_hint_x: None
                        size_hint_x: 0.7
                        width: root.width
                        font_size: 18
                        pos_hint: {"center_x": 0.5}

                    

                    MDBoxLayout:
                        orientation: 'vertical'
                        disabled: False
                        MDCard:
                            md_bg_color: "white"
                            orientation: 'vertical'
                            size_hint: (0.8, 1)
                            pos_hint: {"center_x": 0.5, "top": 1}
                            ScrollView:
                                do_scroll_x: False
                                do_scroll_y: True
                                MDBoxLayout:
                                    spacing: root.height * 0.005
                                    padding: root.height * 0.005
                                    adaptive_height: True
                                    orientation: 'vertical'

                                    ElementShop:
                                    ElementShop:
                                    ElementShop:

        MDBottomNavigationItem:
            id: navigation_bottom_3
            name: "screen 3"
            text:
            icon: 'account-settings-outline'
            disabled: False
            MDFloatLayout:
                id: screen_3
                opacity: 1
                MDCard:
                    radius: 23
                    md_bg_color: "red"
                    size_hint: (0.8272,0.0525)
                    pos_hint: {"center_x": 0.5, "top": 0.9575}
                    MDFloatLayout:
                        md_bg_color:255/255,255/255,255/255,1
                        radius: 23
                        size: self.parent.size
                        size_hint: (0.85,0.85)
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        MDLabel:
                            text: "Меню"
                            padding: [20,0]
                            font_size: 18
                            pos_hint: {"center_x": 0.5, "top": 1}
                            halign: "center"
                            theme_text_color: "Custom"
                            text_color: "black" 
                MDCard:
                    id: settings_screen
                    radius: 25
                    md_bg_color:80/255,87/255,89/255,1
                    size_hint: 0.842, 0.9
                    pos_hint: {"center_x": 0.5, "top": 0.89125}
                    padding: 5
                    spacing: 0
                    orientation: 'vertical'
                    MDFloatLayout:  
                        radius: 25
                        md_bg_color:255/255,255/255,255/255,1                  
                        size: self.parent.size
                        MDCard:
                            radius: 23
                            md_bg_color:239/255,49/255,36/255,1
                            size_hint: (0.8272,0.1596)                  
                            pos_hint: {"center_x": 0.5, "top": 0.97883}
                            MDFloatLayout:                                              
                                size: self.parent.size
                                MDLabel:
                                    text: "Аккаунт"
                                    padding: [20,0]
                                    font_size: 18
                                    pos_hint: {"center_x": 0.5, "top": 1}
                                    halign: "right"
                                    theme_text_color: "Custom"
                                    text_color: "000000"        
                        MDCard:
                            radius: 23
                            md_bg_color:239/255,49/255,36/255,1
                            size_hint: (0.8272,0.1091)                  
                            pos_hint: {"center_x": 0.5, "top": 0.7443}
                            MDFloatLayout:                                              
                                size: self.parent.size
                                MDLabel:
                                    text: "Кэшбэк и бонусы"
                                    padding: [20,0]
                                    font_size: 18
                                    pos_hint: {"center_x": 0.5, "top": 1}
                                    halign: "left"
                                    theme_text_color: "Custom"
                                    text_color: "000000"   
                        MDCard:
                            on_release: app.show_SettingsPage()
                            radius: 23
                            md_bg_color:239/255,49/255,36/255,1
                            size_hint: (0.8272,0.1091)                  
                            pos_hint: {"center_x": 0.5, "top": 0.5863}
                            MDFloatLayout:                                              
                                size: self.parent.size
                                MDLabel:
                                    text: "Настройки"
                                    padding: [20,0]
                                    font_size: 18
                                    pos_hint: {"center_x": 0.5, "top": 1}
                                    halign: "left"
                                    theme_text_color: "Custom"
                                    text_color: "000000"   
                        MDCard:
                            radius: 23
                            md_bg_color:239/255,49/255,36/255,1
                            size_hint: (0.8272,0.17427)                  
                            pos_hint: {"center_x": 0.5, "top": 0.20847}
                            MDFloatLayout:                                              
                                size: self.parent.size
                                MDLabel:
                                    text: "Лицензия и условия"
                                    padding: [20,0]
                                    font_size: 15
                                    pos_hint: {"center_x": 0.5, "top": 1.25}
                                    halign: "left"
                                    theme_text_color: "Custom"
                                    text_color: "000000"   
                                MDLabel:
                                    text: "Версия"
                                    padding: [20,0]
                                    font_size: 15
                                    pos_hint: {"center_x": 0.5, "top": 0.75}
                                    halign: "left"
                                    theme_text_color: "Custom"
                                    text_color: "000000"


<ElementCard>:
    #md_bg_color:69/255,55/255,86/255,1
    width: root.width
    md_bg_color: (217/256, 217/256, 214/256, 1.0)
    height: root.parent.parent.height * 0.30
    size_hint: (0.842, None)
    pos_hint: {"center_x": 0.5, "center_y": 0.5}
    padding: 25
    spacing: 25
    orientation: 'vertical'
    on_release: self.show_qr()
    MDFloatLayout:
        size: self.parent.size
        MDLabel:
            text: "Название магазина"
            theme_text_color: "Custom"
            text_color: "red"
            pos_hint: {"x": 0, "center_y": 0.8}
        MDLabel:
            text: "Кешбэк \nРасстояние в метрах"
            theme_text_color: "Custom"
            text_color: "red"
            pos_hint: {'center_x': 0.5, "center_y": 0.3}
            halign: "right"

<ElementNewCard>:
    #md_bg_color:69/255,55/255,86/255,1
    width: root.width
    md_bg_color: (217/256, 217/256, 214/256, 1.0)
    height: app.root.height * 0.24
    size_hint: (0.842, None)
    pos_hint: {"center_x": 0.5, "center_y": 0.5}
    padding: 25
    spacing: 25
    orientation: 'vertical'
    on_release: self.show_qr()
    MDFloatLayout:
        size: self.parent.size
        MDLabel:
            text: "Название магазина"
            theme_text_color: "Custom"
            text_color: "red"
            pos_hint: {"x": 0, "center_y": 0.8}
        MDLabel:
            text: "Кешбэк \nРасстояние в метрах"
            theme_text_color: "Custom"
            text_color: "red"
            pos_hint: {'center_x': 0.5, "center_y": 0.3}
            halign: "right"

<QrPage>:
    #md_bg_color:69/255,55/255,86/255,1
    background_color: (1,0,0,.5)
    opacity: 100
    width: root.width
    height: root.height
    pos_hint: {"center_x": 0.5, "center_y": 0.5}
    padding: 10
    spacing: 25
    orientation: 'vertical'
    on_release: self.hide_qr()
    MDBoxLayout:
        orientation: 'vertical'
        MDLabel:
            text: "Название магазина"
            # theme_text_color: "Custom"
            # text_color: "red"
            pos_hint: {"x": 0, "center_y": 0.8}

        MDCard:
            radius: 10
            md_bg_color:239/255,49/255,36/255,1
            pos_hint: {"center_x": 0.5, "top": 0.97883}
            MDLabel:
                text: "*Здесь QR*"
                padding: [20,0]
                font_size: 18
                pos_hint: {"center_x": 0.5, "top": 1}
                halign: "right"
                theme_text_color: "Custom"
                text_color: "000000"
    
    MDGridLayout:
        padding: 10
        cols: 2 
        rows: 3
        MDLabel:
            text: "Расстояние"
        MDLabel:
            text: "... метров"
        MDLabel:
            text: "Номер карты"
        MDLabel:
            text: "..."
        MDLabel:
            text: "Статус карты"
        MDLabel:
            text: "..."

<ElementShop>:
    width: root.width
    md_bg_color: (217/256, 217/256, 214/256, 1.0)
    height: self.parent.parent.height * 0.10
    size_hint: (0.95, None)
    pos_hint: {"center_x": 0.5, "center_y": 0.5}
    padding: [15, 15, 15, 15]
    spacing: 10
    orientation: 'vertical'
    on_release: self.show_card_adding()

<ShopAddPage>:
    background_color: (1,0,0,.5)
    opacity: 100
    width: root.width
    height: root.height
    pos_hint: {"center_x": 0.5, "center_y": 0.5}
    padding: 10
    spacing: 25
    orientation: 'vertical'
    on_release: self.hide_ShopAddPage()
    MDBoxLayout:
        orientation: 'vertical'
        MDCard:
            radius: 10
            md_bg_color:239/255,49/255,36/255,1
            size_hint: (0.8272,0.1596)
            pos_hint: {"center_x": 0.5, "top": 0.97883}
            MDBoxLayout:
                size: self.parent.size
                MDLabel:
                    text: "Добавить новую карту []"
                    padding: [20,0]
                    font_size: 18
                    pos_hint: {"center_x": 0.5, "top": 1}
                    halign: "right"
                    theme_text_color: "Custom"
                    text_color: "000000"
    MDBoxLayout:
        orientation: 'vertical'
        MDLabel:
            text: 'Тип карты'
            font_size: 18
            pos_hint: {"center_x": 0.5, "center_н": 0.5}
            halign: "left"
            theme_text_color: "Custom"
            text_color: "black"
        MDTextField:
            mode: "round"
        MDLabel:
            text: 'Номер карты'
            font_size: 18
            pos_hint: {"center_x": 0.5, "center_н": 0.5}
            halign: "left"
            theme_text_color: "Custom"
            text_color: "black"
        MDTextField:
            mode: "round"
    MDBoxLayout:
        MDRoundFlatButton:
            text: "Добавить карту магазина"
            size_hint_x: 0.7
            width: root.width
            font_size: 15
            pos_hint: {"center_x": 0.5}
            on_press: 
                app.add_card()
                root.hide_ShopAddPage()
    MDBoxLayout:


<SettingsPage>:
    background_color: (1,0,0,.5)
    opacity: 100
    width: root.width
    height: root.height
    pos_hint: {"center_x": 0.5, "center_y": 0.5}
    padding: 10
    spacing: 25
    orientation: 'vertical'
    MDFloatLayout:
        opacity: 1
        MDCard:
            radius: 23
            md_bg_color:239/255,49/255,36/255,1
            size_hint: (0.8272,0.0525)                  
            pos_hint: {"center_x": 0.5, "top": 0.9575}
            MDFloatLayout:                                              
                size: self.parent.size
                MDLabel:
                    text: "Настройки"
                    padding: [20,0]
                    font_size: 18
                    pos_hint: {"center_x": 0.5, "top": 1}
                    halign: "center"
                    theme_text_color: "Custom"
                    text_color: "FFFFFF"   
        MDCard:
            on_release: self.parent.parent.hide_SettingsPage()
            radius: 25
            md_bg_color:80/255,87/255,89/255,1
            size_hint: 0.842, 0.7675
            pos_hint: {"center_x": 0.5, "top": 0.88375}
            padding: 5
            spacing: 0
            orientation: 'vertical'
            MDFloatLayout:  
                radius: 25
                md_bg_color:255/255,255/255,255/255,1
                size: self.parent.size

                MDCard:
                    radius: 23
                    padding: 5
                    md_bg_color:239/255,49/255,36/255,1
                    size_hint: (0.8272,0.1743)
                    pos_hint: {"center_x": 0.5, "top": 0.9544}
                    MDFloatLayout:
                        radius: 23
                        size: self.parent.size
                        md_bg_color:255/255,255/255,255/255,1
                        MDLabel:
                            text: "Сортировка"
                            padding: [20,0]
                            font_size: 18
                            pos_hint: {"center_x": 0.5, "top": 1}
                            halign: "left"
                            theme_text_color: "Custom"
                            text_color: "000000"   
                MDCard:
                    on_release: app.show_SettingsPage()
                    radius: 23
                    padding: 5
                    md_bg_color:239/255,49/255,36/255,1
                    size_hint: (0.8272,0.272)                  
                    pos_hint: {"center_x": 0.5, "top": 0.7476}
                    MDFloatLayout:                                              
                        size: self.parent.size
                        radius: 23
                        md_bg_color:255/255,255/255,255/255,1
                        MDLabel:
                            text: "Находить в магазины в пределах:"
                            padding: [20,0]
                            font_size: 18
                            pos_hint: {"center_x": 0.5, "top": 1.25}
                            halign: "left"
                            theme_text_color: "Custom"
                            text_color: "000000"   
                MDCard:
                    radius: 23
                    md_bg_color:239/255,49/255,36/255,1
                    size_hint: (0.8272,0.17427)                  
                    pos_hint: {"center_x": 0.5, "top": 0.20847}
                    MDFloatLayout:                                              
                        size: self.parent.size
                        MDLabel:
                            text: "Тёмная тема"
                            padding: [20,0]
                            font_size: 20
                            pos_hint: {"center_x": 0.5, "top": 1}
                            halign: "left"
                            theme_text_color: "Custom"
                            text_color: "FFFFFF"